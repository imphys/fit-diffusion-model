function A = mm3d(B,C,D)

if nargin == 2
    
    A = zeros(size(B));
    A(1,1,:) = B(1,1,:).*C(1,1,:)+B(1,2,:).*C(2,1,:)+B(1,3,:).*C(3,1,:);
    A(1,2,:) = B(1,1,:).*C(1,2,:)+B(1,2,:).*C(2,2,:)+B(1,3,:).*C(3,2,:); 
    A(1,3,:) = B(1,1,:).*C(1,3,:)+B(1,2,:).*C(2,3,:)+B(1,3,:).*C(3,3,:);
    
    A(2,1,:) = B(2,1,:).*C(1,1,:)+B(2,2,:).*C(2,1,:)+B(2,3,:).*C(3,1,:); 
    A(2,2,:) = B(2,1,:).*C(1,2,:)+B(2,2,:).*C(2,2,:)+B(2,3,:).*C(3,2,:); 
    A(2,3,:) = B(2,1,:).*C(1,3,:)+B(2,2,:).*C(2,3,:)+B(2,3,:).*C(3,3,:); 
    
    A(3,1,:) = B(3,1,:).*C(1,1,:)+B(3,2,:).*C(2,1,:)+B(3,3,:).*C(3,1,:); 
    A(3,2,:) = B(3,1,:).*C(1,2,:)+B(3,2,:).*C(2,2,:)+B(3,3,:).*C(3,2,:); 
    A(3,3,:) = B(3,1,:).*C(1,3,:)+B(3,2,:).*C(2,3,:)+B(3,3,:).*C(3,3,:); 
    
elseif nargin == 3
    
    A = mm3d(mm3d(B,C),D);
    
else
    error('Not supported!');
end

end
